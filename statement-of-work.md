Penetration Test - Statement of Work

**product name and version**

__TODO: update all text in bold. Text in italics, like this, give hints to document authors and needs to be removed__

# Introduction

##	Goal
The objective of this penetration test is to uncover vulnerabilities in the assets of the system being examined, aiming to enhance the system's overall information security. Furthermore, this penetration test is mandatory to demonstrate compliance to internal and external secure software development lifecycle procedures. A comprehensive penetration test report will provide in-depth information on all discoveries, while a summarized report will present a condensed version suitable for sharing with third parties.

##	Approach
This statement-of-work document contains all information towards a potential penetration testing provider including 
1. documentation about the system under test
1. requirements towards the vendor and the penetration testers / ethical hackers
1. definitions of the target of the penetration test
1. the minimum activities required in the execution of the penetration test
1. requirements for the reporting of the penetration test
1. run-down and debriefing activities  

#	System under test

The following documentation is provided as annex to this statement of work document
1. end-user documentation - including configuration, operating environment requirements, users and roles, use cases
1. internal documentation - for example a "new developer quickstart guide" or anything to get pentesters started 
1. list of assets - including asset impact matrix by impediment
1. system architecture - including interfaces, data-flow diagrams, network protocols, SBOM
1. security assessment - threat model, cybersecurity risk management analysis

__TODO:Provide the above information with this SoW. If not available in existing documents or in case you do not want to share the entire document, add it as aub-chapter here, see example below__

## Asset impact matrix
The following matrix highlights protection requirements from a business perspective for each asset per impediment (confidentiality, integrity and availability):

| Asset                        | Confidentiality | Integrity | Availability |
| ---------------------------- | --------------- | --------- | ------------ |
| Patient Health Information   | high            | high      | medium       |
| License information          | high            | medium    | medium       |
| Log files                    | none            | low       | low          |
| Intended Use (functionality) | n/a             | n/a       | critical     |

__TODO: Update that list to match the assets, change C/I/A values according to your business needs__

#	Provider Requirements

The following chapters describe requirements for the penetration testing provider, and its members of staff that directly participate in the penetration test of the system under test.

## Organization

The penetration testing provider must have proven experience in conducting penetration tests in the medical / healthcare industry.

The penetration testing provider and all of the penetration testers must not be involved in any activities related to the development or maintenance of the system under test other than penetration testing. 

The penetration testing provider agrees that the intellectual ownership of all documents created for this penetration test, including but not limited to the pentest report, is transferred to the client. The client may use these documents at their own discretion, including (but not limited to) sharing the documentation with regulatory authorities, customers, or providers for future penetration tests.

The penetration testing background of the organization as well as their independance must be documented in the report.

## Pentest Methodology

The penetration test must follow best practice from at least one of the major frameworks, such as  

* Open-Source Security Testing Methodology Manual (OSSTMM) 
* Penetration Testing Execution Standard (PTES) 
* NIST Technical Guide to Information Security Testing and Assessment (SP 800-115) 
* Information System Security Assessment Framework (ISSAF) 
* OWASP (Web / Mobile / Firmware) Testing Guide 
* BSI Praxis-Leitfaden für IS-Penetrationstests

The methodology of choice must fit the system under test and can be tailored. 

The pentest report must document, which methodology has been chosen by the pentest provider and why. The reporting structure should reflect the activities in the methodology as further evidence ot its adherence.

## Penetration Testers

The penetration test project members responsible for executing the actual testing activities must be skilled and experienced for the purpose of this penetration test. The following certifications are an indication of skill and hsould be accompanied by years of experience in similar pentest projects:

* OffSec Certified Professional (OSCP)  
* EC-Council Certified Ethical Hacker (CEH) or Certified Security Analyst (ECSA) 
* CREST Penetration Testing Certifications 
* Global Information Assurance Certification (GIAC) Certifications 
* Communication Electronic Security Group (CESG) IT Health Check Service (CHECK) 

Penetration testers skills and experience must be documented in the penetration test report.

#	Test Setup


#	Execution

The client will provide the following:

__Move items between these two lists as needed, for example "Location", if the pentest is taking place at the providers location.__

1. Contact information of the primary contact, including e-mail address and telephone number
1. Location - a lab for the duration of the pentest with an isolated testing network as well as a guest WiFi to allow for internet access. Access badges will be provided to named penetration testers only, government ID is required.
1. Credentials - including usernames and passwords, tokens, keys, secrets needed to use the system under test under every role
1. Test data - all data that is needed to execute the happy-path of security-relevant use cases  
1. Secure data exchange - a place where client and provider can exchange files securely during the test - no confidential information shall be sent via e-mail!

The pentest provider will provide the following:

1. Contact information of the primary contact, including e-mail address and telephone number
1. Secure data storage - all data that is received or discovered as part of the penetration test project must be stored securely and never unencrypted. This includes backup or cloud-synchronized data.
1.  Emergency communication - in case of critical findings during the test or in case infrastructure outside of the system under test was harmed by penetration testing activities, the provider will inform the client immediately.
1. Penetration testing equipment, including devices, software & licenses, tooling, analysis equipment, backup

The pentest provider also is in charge of the creation of a project plan and its execution. The plan shall incorporate the following touch points:

## Kick-off meeting

Timing: Day 1, 3 hours

Prerequisites: Penetration testers have access to the system under test and have read the **"Developer Quickstart Guide" (depending on what was delivered to the provider upfront)**

Goal: to ensure penetration testers are able to interact with the system under test over all interfaces, can execute the “happy path” of use cases and all credentials are working. 

Participants: Client Security Engineer, Client Software Developer, Provider Project Manager, Provider Ethical Hackers 

## Daily 

Timing: Every working day, 15 minutes

Goal: Summarize progress and next steps for today. Discuss any road-blocks encountered and have the client to support in their resolution. 
	
Participants: Client Security Engineer, Provider Project Manager, Provider Ethical Hackers (all) 

## Technical deep dive 

Timing: whenever needed 

Goal: In case penetration testers have hit a road block or need support by software developers, e.g. by reviewing certain areas of the source code. 

Participants: Client Security Engineer, Client Software Developer (as needed), Provider Project Manager, Provider Ethical Hackers (as needed) 

## Critical Findings  

Timing: whenever needed 

Goal: In case critical security findings were identified or out-of-scope systems are affected by the pentest, to discuss immediate steps

Participants: Client Security Engineer, Client Software Developer (as needed), Provider Project Manager, Provider Ethical Hackers (as needed) 
 
## Report Preview 

Timing: When report draft is ready, 1 hour 

Goal: Ensure that all reporting requirements are met

Participants: Client Security Engineer, Provider Project Manager 

## Pentest Debrief 

Timing: After the penetration test is finished, 1 hour 

Goal: Final approval of all penetration test deliverables. Feedback (in both directions) and how to further improve. Outlook for re-test. Discussion of shift-left activities. 

Participants: Client Security Engineer, Provider Project Manager 


##	Re-Test

__A re-test is not necessary for the goals of security and compliance. A re-test can however be helpful if you plan to share the pentest report with 3rd parties, such as regulatory authorities or customers. Decide for yourself, if a "clean" report is worth the effort and investment. Either way, leave this chapter in, to keep the option open requesting a re-test later on. On the commercial side, a re-test is often offered for a lump sum of 5-10% of the initial pentest costs.__

The client can request a re-test by the penetration testing provider. They will then verify the remediation applied by the client after the initial test and document the results in an updated version of the reports. The re-test shall not include the explorative scanning activities of a full penetration test. The updated reports shall allow the client to document the successful efforts after treatment of the vulnerabilities and to have a "clean" pentest report that the client can potentially share with 3rd parties.

The re-test shall be an optional item in the offer and the client can decide up to 6 month after the delivery of the inital pentest reports, whether to request a re-test. A re-test of a re-test shall be possible under the penetration test offer as well, in case findings were not correctly addressed in the first remediation attempt.

For the re-test, the client will provide one of the following status for each finding of the initial report:
1. the client has remediated the finding in the updated version provided for the re-test
1. the client has a different risk rating for the finding; expressed via CVSS environmental score metrics alongside a rationale
1. the client has not remediated the finding

The penetration testing provider shall verify all remediated findings in the updated version provided by the client and update the report, if remediation can be confirmed. The penetration testing provider shall check the different risk rating and update the report if they agree, otherwise mark the scoring of the finding as disputed and document both ratings in the report. Findings that have not been remediated will be ignored in the re-test and not receive any updates in the report. See chapter "reporting requirements", on how updates to the reports shall be applied.  

#	Reporting

The penetration testing provider shall create the following two reports to document the entirety of the penetration test. Reports shall be delivered as PDF file format. Focus on content instead of eye-candy aspects. Coloring can be used but must not be used to solely carry relevant information, in case of visually impaired audience or black/white printing. For example, instead of just marking an element red, also print "critical" next to it.

## Summary Report




## Detailed Report

The detailed report shall include everything from the summary report. In addition to that, a list of all findings that were discovered during the pentest. Every finding shall be listed with all of the following information:

* Unique ID
* Title 
* Description 
* Component 
* Affected assets 
* STRIDE category
* Interface: physical & logical (e.g. TCP port) 
* How to reproduce
* Mitigation suggestion 
* CVSS v3.1 base score & vector

The CVSS scoring shall follow the Rubric for Applying CVSS to Medical Devices – see https://www.mitre.org/news-insights/publication/rubric-applying-cvss-medical-devices. Any CVSS factor that is not immediately obvious shall be given a short rationale.

In addition to a printable file format, the list of findings shall be made available by the pentest provider in a machine-readable format, such as CSV. The intention is for the client to be able to import the findings in a vulnerability management solution. 

__Determine if you want to require a more specific file format here; especially if certain formats can be directly imported into the specific vulnerability management solution you plan to use.__

## Update for re-test 

This chapter is only applicable after a re-test has been conducted - see chapter "Re-Test" under "Execution" to learn more. 

Changes to the penetration testing reports triggered by re-test shall be transparent by only adding information. It is not the intention of a re-test to hide any vulnerabilities found in the initial phase of the penetration test. Instead, the client's successful and timely treatment of those findings shall be documenented by the pentest provider. With the pentest provider and not the client issuing an updated version of the reports, a certain level of quality assurance is safeguarded from the perspective of a 3rd party.

The updated penetration test reports shall have their version number increased. A paragraph shall indicate when and on what version of the system under test the re-test has been executed. The vulnerability summary table shall receive another column indicating the new numbers per severity level after remediation. Each finding that the penetration test provider could verify to be remediated shall receive a CVSS score "after remediation". If fully remediated set the impact to confidentiality, integrity and availability to none. If only partially remediated, document the new CVSS score accordingly. In both cases a rationale shall be added.

# De-briefing

## Shift-left

## Secure Data Deletion

## Pentest Improvements
