Penetration Test - Statement of Work

**Product name and version**

**Date**

_TODO: Update all bold text. Text in italics, like for example this line, gives hints to document authors and needs to be removed._

# Introduction

## Goal
The objective of this penetration test is to uncover vulnerabilities in the system being examined, with the goal to enhance the system's overall information security. Furthermore, this penetration test is mandatory to demonstrate compliance with applicable regulations, standards, and contractual obligations. A comprehensive penetration test report will provide in-depth information on all discoveries, while a summarized report will present a condensed version suitable for sharing with third parties. In addition, the penetration test shall also provide an opportunity for the client to learn more about security testing and which activities can be executed by the client in the future.

## Approach
This statement-of-work document contains all information towards a potential penetration testing provider including 
1. Documentation about the system under test
1. Requirements towards the vendor and the penetration testers / ethical hackers
1. Definitions of the target of the penetration test
1. The minimum activities required in the execution of the penetration test
1. Requirements for the penetration test reporting
1. Run-down and post-test activities 

# System Under Test
The following documentation is provided as annex to this statement of work document
1. End-user documentation - including configuration, operating environment requirements, users and roles, use cases
1. Internal documentation - for example a "new developer quick-start guide" or anything to get penetration testers started 
1. List of assets - including asset impact matrix by impediment
1. System architecture - including interfaces, data-flow diagrams, network protocols, SBOM
1. Security assessment - threat model, security risk analysis, known vulnerabilities

_TODO:Provide the above information with this SoW. If not available in existing documents or in case you do not want to share the entire document, add it as sub-chapter here, see example below_

## Asset Impact Matrix
The following matrix highlights protection requirements from a business perspective for each asset per impediment (confidentiality, integrity and availability):

| Asset | Confidentiality | Integrity | Availability |
| ---------------------------- | --------------- | --------- | ------------ |
| Personal health information (PHI) | high | high | medium |
| License information | high | medium | medium |
| Log files | none | low | low |
| Intended Use (functionality) | n/a | n/a | critical |

__TODO: Complete the list with all applicable assets, change C/I/A values according to your business needs__

# Provider Requirements
The following chapters describe requirements for the penetration testing provider, and its personnel participating in the penetration test of the system under test.

## Organization
The penetration testing provider must have proven experience in conducting penetration tests in the industry.

The penetration testing provider and all of the penetration testers must not be involved in any activities related to the development or maintenance of the system under test other than penetration testing. 

The penetration testing provider agrees that the intellectual ownership of all documents created for this penetration test, including (but not limited to) the penetration testing report, is transferred to the client. The client may use these documents at their own discretion, including (but not limited to) sharing the documentation with regulatory authorities, customers, or providers for future penetration tests.

Technical expertise of the penetration testers and level of independence must be documented in the penetration test report.

## Penetration Test Methodology
The penetration test must follow best practice from at least one of the major frameworks, such as 

* Open-Source Security Testing Methodology Manual (OSSTMM) 
* Penetration Testing Execution Standard (PTES) 
* Technical Guide to Information Security Testing and Assessment (NIST SP 800-115) 
* Information System Security Assessment Framework (ISSAF) 
* OWASP (Web / Mobile / Firmware) Testing Guide 
* BSI Ein Praxis-Leitfaden für IS-Penetrationstests

The methodology of choice must fit the system under test and can be tailored. 

The penetration test report must document, which methodology has been chosen by the penetration testing provider and why. The reporting structure should reflect the activities in the methodology as further evidence of its adherence.

## Penetration Testers

The penetration testers responsible for executing the actual testing activities must be skilled and experienced for the purpose of this penetration test. The following certifications are an indication of skill and should be accompanied by years of experience in similar penetration testing projects:

* OffSec Certified Professional (OSCP) 
* EC-Council Certified Ethical Hacker (CEH) or Certified Security Analyst (ECSA) 
* CREST Penetration Testing certifications 
* Global Information Assurance Certification (GIAC) certifications 
* Communication Electronic Security Group (CESG) IT Health Check Service (CHECK) 

Penetration testers skills and experience must be documented in the penetration test report.

# Test Setup
This chapter describes the specific setup for this penetration test.

## Scoping

_TODO: The following chapter is highly dependent on the actual system under test and this template can not give adequate text suggestions. Find below an example that may require rework by the document author._

The system under test is defined by the name and version on the first page of this document. Furthermore, the detailed scope is equivalent to **the components found inside the "medical device" trust boundary** as described in the annex **System Architecture, chapter 3, Data Flow Diagram**, including all external interfaces and the interactions over that trust boundary. 

**Not in scope are the neighboring systems on the other side of these interactions. Out of scope are also the operating system and system tools underneath the software-as-medical-device, as the customer will be responsible for providing this part of the operating environment. Neighboring systems that use proprietary protocols can be provided for the penetration test upon request.**

_TODO: The following suggestions may be applicable, however a review is needed to match the content to your needs._

Out of scope are also all attacks that require social engineering of the users of the system under test.

Destructive testing of the provided hardware requires prior approval by the penetration test client.

Testing of application components running in the cloud are subject to the "Rules of Engagement" for conducting penetration tests on the infrastructure of the respective cloud provider

* https://www.microsoft.com/en-us/msrc/pentest-rules-of-engagement 
* https://aws.amazon.com/security/penetration-testing/
* https://support.google.com/cloud/answer/6262505

_TODO: Identify your cloud provider and replace example links with the applicable one_

## Research Goals

The penetration test methodology describes the explorative approach and gives testers guidance on how to conduct the penetration test. Research goals are additional areas of interest, specific to the system under test, that shall be investigated during the penetration test. Research goals are in addition to the general methodological approach of this penetration test.

_TODO: The following examples are intended to help understanding the idea behind research goals and give inspiration. As those are highly specific to the system under test, those must be replaced with actual goals. Those can be taken from a number of sources, such as the chapter "For future penetration tests" from previous penetration tests. Areas where architects or developers have a bad gut feeling about security, but cannot pin it down to actual vulnerabilities. Assumptions that were made during design and development that, if violated, would result in a vulnerable system._

**Password reset via SMS token: Can penetration testers obtain a new password for a valid user by exploiting the SMS token that is used during password reset without having access to the mobile phone receiving the SMS?** 

**Escaping kiosk mode: The medical device is a Windows application running in kiosk mode. The Windows OS has been configured to prevent users with physical access to the GUI of the device. Can the penetration testers escape kiosk mode and interact with the Windows OS directly?**

**Scope change for vulnerabilities requiring physical access: With physical access and tools to open the device enclosure an attacker can access a serial console for debugging purposes. This is a known vulnerability where the risk has been accepted. Can penetration testers obtain information, such as credentials, via the serial console of one device to exploit ANOTHER device over a remote connections?**

## Product Modifications

For the sole purpose of this penetration test, the system under test has been modified to allow easier and deeper access for penetration testers or prevent false negatives during testing. These modifications are not exiting or securely disabled during production. Vulnerabilities against these functionality must not be filed in the penetration test report. If the penetration testers suspect exploitability in one of these areas, an unmodified system under test can be provided. The modifications and consequent exclusion of functionality during the penetration test shall be documented in the report. 

_TODO: the following are examples intended to serve as inspiration, but are highly dependent on the specific system under test. Consider these if your penetration test would benefit from such modifications. If not, remove the examples or the entire chapter_

**SSH access for user 'root' with static password to allow for authenticated vulnerability scanning. This is not enabled on production settings**

**Serial console to observe the boot process and read log files. Cabling to the exterior of the device has been provided for the penetration test and is not present on a production device**

**Log shipping has been enabled on the product to transfer the syslog unencrypted to IP address 192.168.0.99, UDP port 514. This functionality is disabled by default in a production environment**

# Execution

The penetration testing provider is responsible of the creation of a project plan and its execution. 

The penetration testing provider will provide the following:

1. Contact details of the primary contact, including e-mail address and telephone number
1. Secure data storage - all data that is received or discovered as part of the penetration testing project must be stored securely and never unencrypted on any system under the control of the provider. This includes backup as well as cloud-synchronized data.
1. Emergency communication - in case of critical findings during the test or when infrastructure outside of the system under test was harmed by penetration testing activities, the provider will inform the client immediately.
1. Penetration testing equipment, including devices, software & licenses, tooling, analysis equipment, backup

The client will provide the following:

1. Contact details of the primary contact, including e-mail address and telephone number
1. Location - a lab for the duration of the penetration test with an isolated testing network as well as a guest Wi-Fi to allow for internet access. Access badges will be provided to named penetration testers only; a government-issued identification document is required.
1. Credentials - including usernames and passwords, tokens, keys, secrets needed to use the system under test under every role
1. Test data - all data that is needed to execute the happy-path of security-relevant use cases 
1. Secure data exchange - a place where client and provider can exchange files securely during the test - no confidential information shall be exchanged via e-mail!

_TODO: Move items between these two lists as needed, for example "Location", if the penetration test will take place at the providers location._

The penetration testing project plan shall incorporate the following touch points:

## Kick-off Meeting

Timing: Day 1, 3 hours

Prerequisites: Penetration testers have access to the system under test and have read the **"Developer Quick-Start Guide" (depending on what was delivered to the provider upfront)**

Goal: to ensure penetration testers are able to interact with the system under test over all interfaces, can execute the “happy path” of use cases and all credentials are working. 

Participants: Client Security Engineer, Client Software Developer, Provider Project Manager, Penetration Testers 

## Daily / Stand-up

Timing: Every working day, 15 minutes

Goal: Summarize progress and next steps for that day. Discuss any impediments encountered and have the client to support in their resolution. 
Participants: Client (Security Engineer), Provider (Project Manager, Penetration Testers)

## Technical Deep Dive 

Timing: Whenever needed 

Goal: In case penetration testers have encountered an obstacle or need support by software developers, e.g., by reviewing certain areas of the source code. 

Participants: Client (Security Engineer, Software Developer (as needed)), Provider (Project Manager, Penetration Testers (as needed))

## Critical Findings 

Timing: After identification of critical findings or in case out-of-scope systems were affected

Goal: Discuss details of findings and immediate steps, depending on the specific case

Participants: Client (Security Engineer, Software Developer (as needed)), Provider (Project Manager, Penetration Testers (as needed))

## Report Preview 

Timing: When report draft is ready, 1 hour 

Goal: Ensure that all reporting requirements are met

Participants: Client (Security Engineer), Provider (Project Manager)

## Post-Test Debriefing 

Timing: After the penetration test is finished, 1 hour 

Goal: Final approval of all penetration test deliverables. Feedback (in both directions) and how to further improve. Outlook for re-test. Discussion of shift-left activities. 

Participants: Client Security Engineer, Provider Project Manager 

## Re-Test

_TODO: A re-test can be helpful if you plan to share the penetration test report with third parties, such as regulatory authorities or customers. Decide for yourself, if a "clean" report is worth the time and money. On the commercial side, a re-test is often offered for a lump sum of 5-10% of the initial penetration test costs. It is highly recommended to leave this chapter in, to keep the option open requesting a re-test later on._

The client can request a re-test by the penetration testing provider to verify the remediation applied by the client after the initial test and to document the results in an updated version of the reports. The re-test shall not include the explorative scanning activities of a full penetration test. The updated reports shall allow the client to document the successful efforts after remediation of the vulnerabilities and to have a "clean" penetration test report that the client can potentially share with third parties.

The re-test shall be an optional item in the offer and the client can decide up to 6 months after the delivery of the initial penetration test reports, whether to request a re-test. A re-test of a re-test shall be possible under the penetration test offer as well, in case findings were not correctly addressed in the first remediation attempt.

For the re-test, the client will provide one of the following status for each finding of the initial report:
1. Fixed: The finding has been remediated in the updated product version provided for the re-test
1. Different Risk Rating: the client has concluded a different risk rating for the finding; expressed via CVSS environmental score metrics alongside a rationale
1. Open: the finding has not been remediated and shall be ignored in the re-test

The penetration testing provider shall verify all remediated findings in the updated version provided by the client and update the report, if remediation can be confirmed. The penetration testing provider shall check the different risk rating and update the report if they agree, otherwise mark the scoring of the finding as disputed and document both ratings in the report. Findings that have not been remediated will be ignored in the re-test and not receive any updates in the report. See chapter "Reporting Requirements", on how updates to the reports shall be applied. 

# Reporting Requirements
The penetration testing provider shall create the following two reports to document the entirety of the penetration test. Reports shall be delivered to the client in PDF file format within five business days after the completion of the penetration test. Focus on content instead of eye-candy aspects. Coloring can be used but must not be used to solely carry relevant information, in case of visually impaired audience or black/white printing. For example, instead of just marking an element red, also print "Critical" next to it.

_TODO:If more than one product has been the subject of the test, request one set of penetration test reports per product. Having multiple products in a single report may result in confusion when assigning findings to development teams, during regulatory submissions, or may cause a scope creep during an audit._

## Summary Report
The summary report is intended for an external target audience, such as regulatory authorities or customers. It shall not contain detailed information about individual vulnerabilities. It may also not contain names or contact information about employees.

The summary report shall contain at least the following chapters:
1. Executive Summary: On a single page list product name and version, timeframe/duration of the penetration test, efforts spent, and a table with the number of findings per criticality. Do not list individual findings.
1. Penetration Testing Provider: Company information, skills and experience of penetration testers, declaration of independence from the development team of the system under test
1. Penetration Testing Activities: The methodology chosen for this penetration test, list of activities mapped to the phases of the methodology
1. White-box Testing: List of information that has been provided by the client (e.g. document name and key elements found)
1. Research goals: A high level summary of each research goal, but remain vague. Example: A research goal of “Check if PIN code during password reset process can be brute-forced” could be summarized as “One aspect of user authentication” 
1. Annex: Only, if needed. Generic information should be moved here. For example do not explain in the main content of the report how a CVSS score is calculated.

## Detailed Report

The detailed report is intended for the internal development team. This report shall include everything from the summary report, and a list of all findings that were discovered during the penetration test. For every finding, the following information shall be provided:

* Unique ID
* Title 
* Description 
* Component 
* Affected assets 
* STRIDE category
* Interface: physical and logical (e.g. TCP port) 
* Steps to reproduce, including commands, screenshots
* Mitigation suggestion 
* CVSS v3.1 base score and vector
* CVSS rationale for factors that are not immediately obvious

_Change the above CVSS version as needed_

_Remove the following sentence, if the product is not a medical device_
The CVSS scoring shall follow the Rubric for Applying CVSS to Medical Devices available at https://www.mitre.org/news-insights/publication/rubric-applying-cvss-medical-devices. 

In addition to a printable file format, the list of findings shall be made available by the penetration testing provider in a machine-readable format, such as CSV or Vulnerability Exploitability eXchange (VEX). The client needs to be able to import the findings in a vulnerability management software.

If the penetration testing provider has created scripts for the purpose of this penetration test, those shall be provided as separate source code files. Pasting the source code of the script into the PDF report is discouraged.

__Determine if you want to require a more specific file format here; especially if certain formats can be directly imported into the specific vulnerability management solution you plan to use.__

The detailed report shall also give recommendations "for future penetration tests", when resources during the current test were not sufficient to fully explore areas where the penetration testers are suspecting vulnerabilities but were unable to prove their existence. 

Furthermore, the detailed report shall list the modifications for penetration testing that have been applied to the system under test. The penetration tester shall declare that those ares were excluded from the test because the modifications were enabled solely for the purpose of the test. 

## Re-Test Results
This chapter is only applicable after a re-test has been conducted. For more details refer to chapter "Re-Test" under "Execution". 

Changes to the penetration testing reports triggered by re-test shall be transparent by only adding information. It is not the intention of a re-test to hide any vulnerabilities found in the initial phase of the penetration test. Instead, the client's successful and timely remediation of those findings shall be documented by the penetration testing provider. With the penetration testing provider and not the client issuing an updated version of the reports, a certain level of quality assurance is safeguarded from the perspective of a third party.

The updated penetration test reports shall have their version number increased. A paragraph shall indicate when and on what version of the system under test the re-test has been executed. The vulnerability summary table shall receive another column indicating the new numbers per severity level after remediation. Each finding that the penetration testing provider could verify to be remediated shall receive a CVSS score "after remediation". If fully remediated set the impact to confidentiality, integrity and availability to none. If only partially remediated, document the new CVSS score accordingly. In both cases a rationale shall be added.

# Post-Test Phase
This chapter describes the activities that need to be executed after the actual penetration test has been completed.

## Knowledge Transfer

The penetration testing provider shall identify testing activities that have been conducted during the penetration test and which could be executed by the client in the future. These activities are typically automated scans, not so much manual exploration that requires in-depth penetration testing knowledge. 

The knowledge transfer shall contain more than just a command line to be executed by the client. Often, the obstacle is not starting the tool but understanding the output of the tool and what to do with that. The client shall be enabled to incorporate those tools as new test into their own internal test suites with the intention to execute those independently and regularly as early as possible in the development process ("shift left"). 

If this activity will exceed 4 hours of efforts, it shall be listed as an optional line item in the offer.

## Secure Data Deletion
The penetration testing provider shall securely delete all information discovered during the penetration test as well as all confidential information received from the client for the purpose of the test. This shall include backups of the data as well as cloud-synchronized copies. The deletion shall be executed proactively by the penetration testing provider after the final version of the report has been accepted by the client. The provider shall submit a confirmation of deletion of all data or if certain data elements could not be deleted, list those data elements and give a rationale as to why those could not be deleted. If the client intends to perform a re-test, the client can request the penetration testing provider to extend the retention period to cover the re-test.

## Future Improvements
The penetration testing provider and the client shall give feedback to each other regarding the penetration test process as described by this statement of work. The intention is to further improve this process and capture the needs or pain-points of either parties. 

_TODO: Any feedback regarding the process as described in this document is highly appreciated by the original author of this template. Feel free to create an issue under https://github.com/brahmstaedt/pentest/ or suggest a change and raise a pull request. Or just send a quick thanks via a star-rating in GitHub, if you are just a happy user of this template._
